<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><title>AL&#x27;s blog</title><style data-href="/styles.c5e6176cca06aada31b4.css">code[class*=language-],pre[class*=language-]{color:#c5c8c6;text-shadow:0 1px rgba(0,0,0,.3);font-family:Inconsolata,Monaco,Consolas,Courier New,Courier,monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#1d1f21}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7c7c7c}.token.punctuation{color:#c5c8c6}.namespace{opacity:.7}.token.keyword,.token.property,.token.tag{color:#96cbfe}.token.class-name{color:#ffffb6;text-decoration:underline}.token.boolean,.token.constant{color:#9c9}.token.deleted,.token.symbol{color:#f92672}.token.number{color:#ff73fd}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a8ff60}.token.variable{color:#c6c5fe}.token.operator{color:#ededed}.token.entity{color:#ffffb6}.token.url{color:#96cbfe}.language-css .token.string,.style .token.string{color:#87c38a}.token.atrule,.token.attr-value{color:#f9ee98}.token.function{color:#dad085}.token.regex{color:#e9c062}.token.important{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.indexStyles-module--cardStyles--3U9HW{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:left;justify-content:left}.headerStyles-module--navLink--b0Npd{color:#fff;display:inline-block;font-family:Helvetica,Verdana,sans-serif;font-size:17px;font-weight:100;margin-left:15px;margin-right:15px;text-decoration:none}.headerStyles-module--navLink--b0Npd:hover{cursor:pointer}.headerStyles-module--mobileNavLink--3QKVx{color:#fff;font-family:Helvetica,Verdana,sans-serif;font-size:17px;font-weight:100;margin:25px 0;text-decoration:none}.headerStyles-module--navLinks--1e-eo{list-style:none}.headerStyles-module--nav--3kbAQ{float:left}.headerStyles-module--buttonsContainer--2KLLg{max-width:38rem;width:100%}.headerStyles-module--title--1eNkk{color:#fff;font-family:Helvetica,Verdana,sans-serif;font-size:20px;font-weight:500;float:left;height:40px;margin:15px;text-decoration:none}.headerStyles-module--title--1eNkk:hover{cursor:pointer;opacity:.7}.headerStyles-module--themeSwitch--33H1Z{float:right;height:40px;margin:10px}.headerStyles-module--mobileMenuItems--2chnY{margin-top:60px;list-style:none}.headerStyles-module--mobileMenuContainer--2v6Z6{background-color:#000!important;color:#fff!important}.headerStyles-module--mobileMenuButton--1U1Xf{margin:12px 0 10px 8px}.headerStyles-module--headerContainer--3WrSF{display:-webkit-flex;display:flex;height:55px;left:0;position:fixed;top:0;width:100%;z-index:100}.headerStyles-module--headerContainerNonMobile--1dBnb{-webkit-justify-content:center;justify-content:center}.centerContentStyles-module--modalBackdrop--zadc-{background:rgba(0,0,0,.57);position:fixed;left:0;top:0;width:100%;height:100%;opacity:0;pointer-events:none;will-change:opacity;transition:opacity .333s cubic-bezier(0,0,.21,1)}.centerContentStyles-module--backdropVisible--1N8zn{opacity:1;pointer-events:auto}.centerContentStyles-module--modalContent--2lows{background:#fff;border-radius:2px;box-shadow:0 0 14px rgba(0,0,0,.24),0 14px 28px rgba(0,0,0,.48);font-family:Helvetica,Verdana,sans-serif;overflow-y:auto;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%) translateY(30px);transform:translate(-50%,-50%) translateY(30px);transition:-webkit-transform .333s cubic-bezier(0,0,.21,1) .05s;transition:transform .333s cubic-bezier(0,0,.21,1) .05s;transition:transform .333s cubic-bezier(0,0,.21,1) .05s,-webkit-transform .333s cubic-bezier(0,0,.21,1) .05s;padding:16px;min-height:200px;width:90%}.centerContentStyles-module--modalContent--2lows.centerContentStyles-module--small--3JBnz{max-height:50%;max-width:400px}.centerContentStyles-module--modalContent--2lows.centerContentStyles-module--medium--1OVsR{max-height:70%;max-width:700px}.centerContentStyles-module--modalContent--2lows.centerContentStyles-module--large--N8XMm{max-height:80%;max-width:1000px}.slideOutContentStyles-module--ModalContainer--1A0Iq{bottom:0;left:0;position:fixed;right:0;top:0;visibility:hidden;z-index:500}.slideOutContentStyles-module--ModalOpen--eycXh{visibility:visible}.slideOutContentStyles-module--ModalCloseArea--1kZF7{background-color:rgba(6,6,8,.6);bottom:0;position:absolute;left:0;right:0;top:0}.slideOutContentStyles-module--ModalContent--3Rm5r{background-color:#fff;border-right:1px solid #282d33;border-left:1px solid #282d33;color:#000;height:100vh;max-width:90%;overflow:auto;position:absolute;top:0;-webkit-transform:translateX(100%);transform:translateX(100%);transition:all .6s cubic-bezier(.255,.445,.495,1.005);width:200px;z-index:700}.slideOutContentStyles-module--modalLeft--2aPTQ{-webkit-transform:translateX(-100%);transform:translateX(-100%);left:0}.slideOutContentStyles-module--modalRight--3Wp9q{-webkit-transform:translateX(100%);transform:translateX(100%);right:0}.slideOutContentStyles-module--ModalContentOpen--30z23{-webkit-transform:translateX(0);transform:translateX(0)}.cancelModalButtonStyles-module--cancelButton--3caKn{float:right;margin:10px}.cancelModalButtonStyles-module--cancelButton--3caKn:hover{cursor:pointer;opacity:.3}.switchStyles-module--iconStyle--u8zJx{-webkit-align-items:center;align-items:center;color:#fff;display:-webkit-flex;display:flex;font-family:Helvetica,Verdana,sans-serif;font-size:15;height:100%;-webkit-justify-content:center;justify-content:center}.darkThemeStyles-module--headerColor--r4rx8{background-color:#282d33}.darkThemeStyles-module--backgroundColor--2n-YJ{background-color:#000}.darkThemeStyles-module--cardStyles--36D2i{background-color:#282d33;color:#fff}.darkThemeStyles-module--cardStyles--36D2i h2{color:#fff}.lightThemeStyles-module--headerColor--30jfX{background:#248ec4}.lightThemeStyles-module--backgroundColor--36-jH{background-color:#dae0e7}.lightThemeStyles-module--cardStyles--2L9qM{background-color:#fff;color:#000}.lightThemeStyles-module--cardStyles--2L9qM h2{color:#248ec4}.pageStyles-module--contentContainer--1z7Bs{width:100%;height:100%;min-height:100vh;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:center;justify-content:center}.pageStyles-module--mainContent--2_Ihi{margin-top:55px;padding:6px;max-width:38rem;width:100%;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center}.cardStyles-module--card--10a1J{padding:.5rem 2rem;margin:6px 0;border-radius:2px;box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);font-family:Helvetica,Verdana,sans-serif;display:-webkit-flex;display:flex;max-width:38rem}.cardStyles-module--card--10a1J>a{text-decoration:none}.cardStyles-module--cardDesktop--1x6V5{width:100%}.cardStyles-module--cardMobile--xv7zN{width:80%}.tagButtonStyles-module--tagButton--DtpfK{font-family:inherit;font-size:10px;text-decoration:none;color:inherit;border:1px solid;padding:2px 3px;border-radius:4px;opacity:.8}.tagButtonStyles-module--tagButton--DtpfK:hover{opacity:.3}</style><meta name="generator" content="Gatsby 2.3.14"/><link as="script" rel="preload" href="/1-d79380aa887a9fb5d2ec.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-989b7528df93518285d7.js"/><link as="script" rel="preload" href="/app-0cf16fd2b3543b40adc0.js"/><link as="script" rel="preload" href="/styles-3ebdc273971caf80c754.js"/><link as="script" rel="preload" href="/webpack-runtime-a0d759c059b582655ed9.js"/><link as="fetch" rel="preload" href="/static/d/461/path---compound-components-modal-c-9-f-e57-LFTna5RB527a5V5mAnMG22DJEU.json" crossorigin="use-credentials"/></head><body style="margin:0;padding:0"><noscript id="gatsby-noscript">I use javascript a lot as a programmer. I&#x27;m not sure what you&#x27;d expect to see here without javascript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div><header class="headerStyles-module--headerContainer--3WrSF headerStyles-module--headerContainerNonMobile--1dBnb lightThemeStyles-module--headerColor--30jfX"><div class="headerStyles-module--buttonsContainer--2KLLg"><a class="headerStyles-module--title--1eNkk" href="/">Aarron Lee</a><nav class="headerStyles-module--nav--3kbAQ"><ul class="headerStyles-module--navLink--b0Npd"><li class="headerStyles-module--navLink--b0Npd"><a class="headerStyles-module--navLink--b0Npd" href="/">Blog</a></li><li class="headerStyles-module--navLink--b0Npd"><a class="headerStyles-module--navLink--b0Npd" href="/about">About</a></li></ul></nav></div><div class="headerStyles-module--themeSwitch--33H1Z" style="position:relative;display:inline-block;text-align:left;opacity:1;border-radius:14px;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s;touch-action:none;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none"><div class="react-switch-bg" style="height:28px;width:56px;margin:0;position:relative;background:#000000;border-radius:14px;cursor:pointer;-webkit-transition:background 0.25s;-moz-transition:background 0.25s;transition:background 0.25s"><div style="height:28px;width:30px;position:relative;opacity:1;pointer-events:none;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s"><div class="switchStyles-module--iconStyle--u8zJx">L</div></div><div style="height:28px;width:30px;position:absolute;opacity:0;right:0;top:0;pointer-events:none;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s"><div class="switchStyles-module--iconStyle--u8zJx">D</div></div></div><div class="react-switch-handle" style="height:26px;width:26px;background:#ffffff;display:inline-block;cursor:pointer;border-radius:50%;position:absolute;transform:translateX(29px);top:1px;outline:0;border:0;-webkit-transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s;-moz-transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s;transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s"></div><input type="checkbox" role="switch" checked="" style="border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px"/></div></header><div class="lightThemeStyles-module--backgroundColor--36-jH pageStyles-module--contentContainer--1z7Bs"><main class="pageStyles-module--mainContent--2_Ihi"><div class="cardStyles-module--card--10a1J cardStyles-module--cardDesktop--1x6V5 lightThemeStyles-module--cardStyles--2L9qM "><div class="blog-post-container" style="width:100%"><div class="blog-post"><h1>Building Flexible and Reusable React Compound Components</h1><h5>April 25, 2019<!-- --> - Time To Read: <!-- -->7<!-- --> <!-- -->mins</h5><div style="font-size:13px"><strong>tags:</strong> <a class="tagButtonStyles-module--tagButton--DtpfK" href="/tags/Compound Components">Compound Components</a> <a class="tagButtonStyles-module--tagButton--DtpfK" href="/tags/React">React</a> <a class="tagButtonStyles-module--tagButton--DtpfK" href="/tags/javascript">javascript</a> <a class="tagButtonStyles-module--tagButton--DtpfK" href="/tags/react context">react context</a> </div><div class="blog-post-content"><p>Recently, I've been thinking about designing well made, reusable React components. This was after running into some painfully inflexible components in production, where generic components weren't developed with future reuse in mind.</p>
<p>For instance, imagine a Modal component that can be used as seen below:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// this isn't a real component I've seen/used, this is</span>
<span class="token comment">// just for demonstration purposes</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal</span></span>
  <span class="token attr-name">content</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">"modal content"</span><span class="token punctuation">}</span></span>
  <span class="token attr-name">onOpen</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"opened"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
  <span class="token attr-name">onClose</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"closed"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
  <span class="token attr-name">customContentStyle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> backgroundColor<span class="token punctuation">:</span> <span class="token string">"blue"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
  <span class="token attr-name">OpenButtonComponent</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>OpenButton<span class="token punctuation">}</span></span>
  <span class="token attr-name">CloseButtonComponent</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>CloseButton<span class="token punctuation">}</span></span>
<span class="token punctuation">/></span></span></code></pre></div>
<p>There's a few immediate problems to note with this component:</p>
<ol>
<li>The component is completely inflexible. You have no control over how the modal's components will be rendered, and if you want something like custom behavior, you're screwed.</li>
<li>You are overloading the Modal with too many props. As a rule of thumb, if you're adding too many props to a component, you most likely are delegating too much responsibility to this component, and should be broken down to several components instead.</li>
</ol>
<p>As a step up from this, you can implement a modal component like this:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// From React Modal docs:</span>
<span class="token comment">// https://github.com/reactjs/react-modal</span>
<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      modalIsOpen<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>openModal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">openModal</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>afterOpenModal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">afterOpenModal</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>closeModal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">closeModal</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">openModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> modalIsOpen<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">afterOpenModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// references are now sync'd and can be accessed.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subtitle<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"#f00"</span>
  <span class="token punctuation">}</span>

  <span class="token function">closeModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> modalIsOpen<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>openModal<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Open Modal</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal</span></span>
          <span class="token attr-name">isOpen</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>modalIsOpen<span class="token punctuation">}</span></span>
          <span class="token attr-name">onAfterOpen</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>afterOpenModal<span class="token punctuation">}</span></span>
          <span class="token attr-name">onRequestClose</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>closeModal<span class="token punctuation">}</span></span>
          <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>customStyles<span class="token punctuation">}</span></span>
          <span class="token attr-name">contentLabel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Example Modal<span class="token punctuation">"</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">subtitle</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subtitle <span class="token operator">=</span> subtitle<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Hello</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>closeModal<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">close</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">I am a modal</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token punctuation">/></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">tab navigation</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">stays</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">inside</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">the modal</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This is already much better than the first implementation because:</p>
<ol>
<li>You have far more flexibility and control with managing the Modal, and you have solid primitives that enable you to create the Modal that you need</li>
<li>You are no longer overloading the Modal props; instead, you are delegating the props to the component that it is relevant to.</li>
</ol>
<p>However, I still think this modal is problematic. <strong>It is too imperative</strong>: Every time you want to create a modal, you need to create some react state to manage the modal state, hook up the components to the proper open/close callbacks, hook up the components to the isOpen/Closed state, etc.</p>
<p>Having to write all this boilerplate for a Modal wastes developer time, which I believe is a code smell of sorts. Imperatively writing a Modal component like this every time you need a modal implies that this pattern, too, isn't quite suitable for the situation at hand.</p>
<p>In this situation, my goal would be to <strong>determine a reasonable set of default behaviors for components, while providing a flexible API for developers to consume.</strong></p>
<p>Thus, as a spoiler, let's first look at the end result I ended up creating:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> Modal <span class="token keyword">from</span> <span class="token string">"./Modal"</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal.Content</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Hello world</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal.CloseButton</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">"blue"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Cancel</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal.CloseButton</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal.Content</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal.OpenButton</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> openModal <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token comment">// if you need a custom render, provide a child render prop</span>
        <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>openModal<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Open Modal</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal.OpenButton</span></span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal</span></span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span></code></pre></div>
<p>This solves the issues I described so far:</p>
<ol>
<li>The usage of the Modal component is now completely declarative, and is already built with reasonable defaults in behavior. You don't need to hook up buttons to the modal state, the default components already provide the expected behavior you want.</li>
<li>You can pass on props directly to the components that may need them, such as styles to a button, etc. This means that you have the flexibility to manage each component in isolation, rather than overloading one single component with too many props.</li>
<li>If you need custom behavior, you are provided with a mechanism (via children as a render prop) to overwrite rendering behavior with whatever custom behavior you want. This is pretty much inversion of control, where the Modal's components can provide useful functions as a dependency injection.</li>
</ol>
<p>To achieve this, I created a set of tightly coupled components that share state via a React Context object (this React pattern is called "Compound Components", introduced by <a href="https://kentcdodds.com/">Kent Dodds</a>).</p>
<p>What makes this pattern particularly powerful is that you are using a React context object to purposefully couple together components to enable powerful behavior when used in tandem.</p>
<p>In the case of this Modal, the usage of a React context object means you no longer need to worry about drilling props from parent to child components. You can have something like this:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> Modal<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token constant">MODAL_SIZES</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"modal"</span>

<span class="token keyword">const</span> <span class="token function-variable function">CloseButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal.CloseButton</span></span><span class="token punctuation">></span></span><span class="token plain-text">Close Button</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal.CloseButton</span></span><span class="token punctuation">></span></span>

<span class="token keyword">const</span> <span class="token function-variable function">ButtonContainer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    Button Container
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CloseButton</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal</span></span> <span class="token attr-name">size</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">MODAL_SIZES</span><span class="token punctuation">.</span><span class="token constant">MEDIUM</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal.Content</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Hello World</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token comment">/* notice how the Modal.CloseButton is nested deeply
        but because you're using a context object behind the scenes,
        you don't need to pass down the modal's state to the button!*/</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ButtonContainer</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal.Content</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal.OpenButton</span></span><span class="token punctuation">></span></span><span class="token plain-text">Open Button</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal.OpenButton</span></span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal</span></span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span></code></pre></div>
<p>A basic implementation of this Modal seen below (<a href="https://github.com/aarron-lee/climate_change_pwa/blob/master/app/Components/Presentation/Modal/Modal.jsx">click here for demonstration source code</a>):</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// Note, this component has room for some cleanup</span>
<span class="token comment">// But this is for demonstration purposes only</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Portal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-portal"</span>

<span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">"./ModalStyles"</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">MODAL_SIZES</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">SMALL</span><span class="token punctuation">:</span> <span class="token string">"small"</span><span class="token punctuation">,</span>
  <span class="token constant">MEDIUM</span><span class="token punctuation">:</span> <span class="token string">"medium"</span><span class="token punctuation">,</span>
  <span class="token constant">LARGE</span><span class="token punctuation">:</span> <span class="token string">"large"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// create context object</span>
<span class="token keyword">const</span> ModalContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> Provider<span class="token punctuation">,</span> Consumer <span class="token punctuation">}</span> <span class="token operator">=</span> ModalContext

<span class="token keyword">const</span> <span class="token function-variable function">ToggleButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children<span class="token punctuation">,</span> openOnClick <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Consumer</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> modalIsOpen<span class="token punctuation">,</span> toggleModal <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>children <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> children <span class="token operator">===</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          modalIsOpen<span class="token punctuation">,</span>
          toggleModal<span class="token punctuation">,</span>
          <span class="token function-variable function">openModal</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">toggleModal</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token function-variable function">closeModal</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">toggleModal</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">let</span> <span class="token function-variable function">changeModalState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">toggleModal</span><span class="token punctuation">(</span>openOnClick<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>changeModalState<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Consumer</span></span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Modal</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    modalIsOpen<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function-variable function">Content</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ModalContext.Consumer</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> modalIsOpen<span class="token punctuation">,</span> toggleModal<span class="token punctuation">,</span> contentSize <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token function-variable function">closeModal</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>modalIsOpen<span class="token punctuation">)</span> <span class="token function">toggleModal</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Portal</span></span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
              <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">.</span>modalBackdrop<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
                modalIsOpen <span class="token operator">?</span> styles<span class="token punctuation">.</span>backdropVisible <span class="token punctuation">:</span> <span class="token string">""</span>
              <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span></span>
              <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>closeModal<span class="token punctuation">}</span></span>
            <span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
                <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">.</span>modalContent<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">[</span>contentSize<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span></span>
                <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token operator">=></span> e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
              <span class="token punctuation">></span></span><span class="token plain-text">
                </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Portal</span></span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ModalContext.Consumer</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>

  <span class="token keyword">static</span> <span class="token function-variable function">CloseButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ToggleButton</span></span> <span class="token attr-name">openOnClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ToggleButton</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>

  <span class="token keyword">static</span> <span class="token function-variable function">OpenButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ToggleButton</span></span> <span class="token attr-name">openOnClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ToggleButton</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>

  <span class="token function-variable function">toggleModal</span> <span class="token operator">=</span> <span class="token parameter">newModalState</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> modalIsOpen<span class="token punctuation">:</span> newModalState <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Provider</span></span>
        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
          modalIsOpen<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>modalIsOpen<span class="token punctuation">,</span>
          toggleModal<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>toggleModal<span class="token punctuation">,</span>
          contentSize<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Provider</span></span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Modal<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  size<span class="token punctuation">:</span> <span class="token constant">MODAL_SIZES</span><span class="token punctuation">.</span><span class="token constant">MEDIUM</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Modal</code></pre></div>
<p>So what enables this to work? Let's explain:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> ModalContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Provider<span class="token punctuation">,</span> Consumer <span class="token punctuation">}</span> <span class="token operator">=</span> ModalContext</code></pre></div>
<p>Since this file is a javascript module, that means anything else declared in this file has a reference to this context object via lexical scoping (aka closure). Thus, any component declared in this file maintains a reference to this context object.</p>
<p>What this means is that, as seen in the <code class="language-text">Modal.Content</code>, <code class="language-text">Modal.CloseButton</code>, etc, they can all reference the same context object, and pull out values from this shared context object. Since the context object has <code class="language-text">modalIsOpen: boolean</code> and <code class="language-text">toggleModal : function</code>, these components can easily pull out whatever it needs from the Context object, and use it to fulfill it's desired default behavior.</p>
<p>Now, there is a caveat with this implementation: since we're using a React context object, any time the values in the context changes, it induces a complete rerender of all children in the Context Provider component. In this particular case, I would argue that you should do a full rerender, mainly because the only value that should really be changing is the <code class="language-text">modalIsOpen</code> boolean. If it's toggled from true to false, you need to hide/unhide the modal anyways.</p>
<p>Nonetheless, depending on your use case, you should be aware of this caveat. On the upside, you get a powerful set of declarative, reusable components that should be usable for most standard modals you may need.</p></div></div><div style="display:flex;flex-direction:row;justify-content:space-between;width:100%;margin:25px 0px"><div style="opacity:0.3">← No More Posts</div><a style="color:inherit" href="/plex-docker-compose">Running a Plex Media Server with Docker Compose<!-- --> →</a></div></div></div></main></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"compound-components-modal-c9f","path":"/compound-components-modal"};window.dataPath="461/path---compound-components-modal-c-9-f-e57-LFTna5RB527a5V5mAnMG22DJEU";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-0cf16fd2b3543b40adc0.js"],"component---src-about-index-js":["/component---src-about-index-js-e5404b4bc83ffd4d1028.js"],"component---src-templates-all-tags-index-js":["/component---src-templates-all-tags-index-js-5b4218d1ea32fbe93272.js"],"component---src-templates-single-tag-index-js":["/component---src-templates-single-tag-index-js-9e8014515aeea09a88a3.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-989b7528df93518285d7.js"],"component---src-pages-index-js":["/component---src-pages-index-js-817f220a7b3a000f9dc5.js"],"pages-manifest":["/pages-manifest-c825b6f3af789c968977.js"]};/*]]>*/</script><script src="/webpack-runtime-a0d759c059b582655ed9.js" async=""></script><script src="/styles-3ebdc273971caf80c754.js" async=""></script><script src="/app-0cf16fd2b3543b40adc0.js" async=""></script><script src="/component---src-templates-blog-post-js-989b7528df93518285d7.js" async=""></script><script src="/1-d79380aa887a9fb5d2ec.js" async=""></script></body></html>